!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){JEFRi.Stores=a.exports={ObjectStore:c(1),CouchStore:c(2),PostStore:c(3),LocalStore:c(4)}},function(a,b,c){var d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=c(5),d=function(a){function b(a){if(this.settings={version:"1.0",size:Math.pow(2,16)},Object.assign(this.settings,a),this._store={},!this.settings.runtime)throw{message:"LocalStore instantiated without runtime to reference."}}var c,d;return f(b,a),b.prototype._set=function(a,b){return this._store[a]=b},b.prototype._get=function(a){return this._store[a]||"{}"},b.prototype.execute=function(a,b){var c;return b=d(b),this.emit("sending",b),this["do_"+a](b),this.settings.runtime.expand(b),c=e.promise(),c(!0,b),c},b.prototype.get=function(a){return this.execute("get",a)},b.prototype.persist=function(a){return this.execute("persist",a)},b.prototype.do_persist=function(a){var b;return a.entities=function(){var c,d,e,f;for(e=a.entities,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(this._save(b));return f}.call(this)},b.prototype._save=function(a){return a=Object.assign(this._find(a),a),this._set(this._key(a),JSON.stringify(a)),this._type(a._type,a._id),a},b.prototype.do_get=function(a){var b,c,d,e,f,g,h,i,j;for(c={},j=a.entities,h=0,i=j.length;i>h;h++)b=j[h],d=this._lookup(b),(g=function(a){var b,d,e,f,h,i,j;if(a){if(a.hasOwnProperty("_type"))return c[a._id]=a;if(Array.isArray(a)){for(i=[],f=0,h=a.length;h>f;f++)e=a[f],i.push(g(e));return i}j=[];for(d in a)b=a[d],j.push(g(b));return j}})(d);return a.entities=function(){var a;a=[];for(e in c)f=c[e],a.push(f);return a}(),a},b.prototype._find=function(a){return JSON.parse(this._get(this._key(a)))},b.prototype._lookup=function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;for(b=this.settings.runtime.definition(a._type),n=[],t=Object.keys(this._type(a._type)),p=0,r=t.length;r>p;p++)h=t[p],n.push(JSON.parse(this._get(this._key(a,h))));if(0!==n.length){b.key in a&&(n=n.filter(function(c){return c._id===a[b.key]})),u=b.properties;for(j in u)k=u[j],j in a&&j!==b.key&&(n=n.filter(c(j,k,a[j])));v=b.relationships;for(j in v)if(m=v[j],j in a){f=[],o=[];for(g in n)e=n[g],l=function(b){return function(){var c;return c=Object.assign({},a[j],{_type:m.to.type}),c[m.to.property]=e[m.property],b._lookup(c)||[]}}(this)(),l.length&&f.push(l);for(o.reverse(),q=0,s=o.length;s>q;q++)g=o[q],i=g+1,d=n[i(til(n.length))],n=n.slice(0,+g+1||9e9),[].push.apply(n,d);[].push.apply(n,f)}return n}},b.prototype._type=function(a,b){var c;return null==b&&(b=null),c=JSON.parse(this._get(a)||"{}"),b&&(c[b]="",this._set(a,JSON.stringify(c))),c},b.prototype._key=function(a,b){var c;return null==b&&(b=a._id),c=a._type,c+"/"+b},c=function(a,b,d){var e,f;if(Object.isNumber(d)&&(d=d%1===0?["=",d]:[d,8]),Object.isString(d)&&(d=["REGEX",".*"+d+".*"]),d||(d=["=",void 0]),!Array.isArray(d))throw{message:"Lookup specification is invalid (in LocalStore::_sieve).",name:a,property:b,spec:d};if(Object.isNumber(d[0]))return function(b){return Math.abs(b[a]-d[0])<Math.pow(2,-d[1])};if(Array.isArray(d[0]))return d[e]=function(){var g,h,i;for(i=[],e=g=0,h=d.length;h>g;e=++g)f=d[e],i.push(c(a,b,d[e]));return i}(),function(a){var b,c,e;for(c=0,e=d.length;e>c;c++)if(b=d[c],!b(a))return!1;return!0};switch(d[0]){case"=":return function(b){return b[a]===d[1]};case"<=":return function(b){return b[a]<=d[1]};case">=":return function(b){return b[a]>=d[1]};case"<":return function(b){return b[a]<d[1]};case">":return function(b){return b[a]>d[1]};case"REGEX":return function(b){return(""+b[a]).match(d[1])};default:return function(b){for(var c;c=d.shift;)if(b[a]===c)return!0;return!1}}},d=function(a){return Function.isFunction(a.encode)||(a=new JEFRi.Transaction(a)),a.encode()},b}(e.Event),a.exports=d},function(){var a,b;b=this,b.JEFRi=b.JEFRi?b.JEFRi:{},a=function(){function a(a){if(this.settings={version:"1.0",size:Math.pow(2,16)},_.extend(this.settings,a),!this.settings.runtime)throw{message:"CouchStore instantiated without runtime to reference."}}return a.prototype.execute=function(a,b){var c,d;return d=JSON.parse(b.toString()),_(this).trigger("sending",[a,"couchStorage:",d,this]),"persist"===a?c=this.persist(b):"get"===a&&(c=this.get(b)),c.resolve({}).promise()},a.prototype.persist=function(){return _.Deferred()},a.prototype.get=function(){return _.Deferred()},a}(),b.JEFRi.CouchStore=a},function(a){var b,c=function(a,b){return function(){return a.apply(b,arguments)}};a.exports=b=function(){function a(a){if(this._send=c(this._send,this),this.settings={version:"1.0",size:Math.pow(2,16)},_.extend(this.settings,a),!this.settings.runtime)throw{message:"LocalStore instantiated without runtime to reference."};this.settings.remote?Object.assign(this,{get:function(a){var b;return b=this.settings.remote+"get",this._send(b,a,"getting","gotten")},persist:function(a){var b;return b=this.settings.remote+"persist",this._send(b,a,"persisting","persisted")}}):this.get=this.persist=function(a){return a.entities=[],Q.Defer().resolve(a).promise}}return a.prototype._send=function(a,b){return Request.post(a,{data:b.toString(),dataType:"application/json"}).then(function(a){return function(b){return _(b).isString()&&(b=JSON.parse(b)),a.settings.runtime.expand(b),b}}(this))},a}(),Object.assign(b.prototype,{execute:function(a,b){return this[a](b)}})},function(a,b,c){var d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=c(1),d=function(a){function b(a){b.__super__.constructor.call(this,a)}return f(b,a),b.prototype._set=function(a,b){return localStorage[a]=b},b.prototype._get=function(a){return localStorage[a]||"{}"},b.prototype._key=function(a,c){return null==c&&(c=a._id),b.__super__._key.call(this,a,c).replace("/",".")},b}(e),a.exports=d},function(a,b,c){c(6),a.exports={Event:c(10),lock:c(7),promise:c(8),request:c(11),UUID:c(9)},"object"==typeof window&&null!==window&&(window.jiffies=a.exports)},function(){[].includes||(Array.prototype.includes=function(a){"use strict";var b=Object(this),c=parseInt(b.length)||0;if(0===c)return!1;var d,e=parseInt(arguments[1])||0;e>=0?d=e:(d=c+e,0>d&&(d=0));for(var f;c>d;){if(f=b[d],a===f||a!==a&&f!==f)return!0;d++}return!1}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(a){"use strict";if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e=Object.keys(Object(d)),f=0,g=e.length;g>f;f++){var h=e[f],i=Object.getOwnPropertyDescriptor(d,h);void 0!==i&&i.enumerable&&(b[h]=d[h])}}return b}}),Object.isString||(Object.isString=function(a){return"string"==typeof a}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Function.isFunction||(Function.isFunction=function(a){return"function"==typeof a}),Object.isObject||(Object.isObject=function(a){return"object"==typeof a&&null!==a||!1}),Object.isNumber||(Object.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)})},function(a){a.exports=function(a){return function(){var b,c;if(!a.__locked){a.__locked=!0;try{b=a.apply(this,arguments)}catch(d){c=d}}if(a.__locked=!1,c)throw c;return b}}},function(a,b,c){(function(a,b,c){!function(a){function d(a){"undefined"!=typeof b?b(a):"undefined"!=typeof c&&c.nextTick?c.nextTick(a):setTimeout(a,0)}var e;a[0][a[1]]=function f(a){var b,c=[],g=[],h=function(a,e){return null==b&&null!=a&&(b=a,c=Array.isArray(e)?e:[e],g.length&&d(function(){for(var a=0;a<g.length;a++)g[a]()})),b};return h.then=function(h,i){function j(a){function b(){f++||j.apply(e,arguments)}function c(a){f++||k(!1,[a])}var d,f=0;try{if(a&&Function.isFunction(d=a.then)){if(a===k)throw new TypeError;d.call(a,b,c)}else k(!0,arguments)}catch(g){f++||k(!1,[g])}}var k=f(a),l=function(){try{var a=b?h:i;Function.isFunction(a)?j(a.apply(e,c||[])):k(b,c)}catch(d){k(!1,[d])}};return null!=b?d(l):g.push(l),k},h["catch"]=function(a){return h.then(function(){},a)},h["finally"]=function(a){return h["catch"](function(){return null}).then(a)},h.done=function(){return null},a&&(h=a(h)),h}}([a,"exports"])}).call(b,c(15)(a),c(13).setImmediate,c(14))},function(a,b,c){var d={};a.exports=d,d.rvalid=/^\{?[0-9a-f]{8}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{12}\}?$/i;var e=c(12);d.v4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=15&e(1),c="x"===a?b:3&b|8;return c.toString(16)})}},function(a){var b;a.exports=b=function(){},b.prototype={on:function(a,b){var c;return null==this._listeners&&(this._listeners={}),c=this._listeners,null==c[a]&&(c[a]=[]),c[a].includes(b)?void 0:c[a].push(b)},off:function(a,b){var c,d;if(null!=this._listeners)return d=this._listeners,c=d[a].indexOf(b),-1!==c?d[a].splice(c,1):void 0},emit:function(a){var b,c,d,e,f,g;if(null!=this._listeners&&(d=this._listeners,c=d[a],null!=c)){for(a.target=this,g=[],e=0,f=c.length;f>e;e++)b=c[e],g.push(b.call(this,a));return g}}}},function(a,b,c){var d;d=c(16),a.exports=function(a){return""===a?Promise()(!0):d.get(a)},a.exports.get=d.get,a.exports.post=d.post},function(a){a.exports=function(a){var b=new Uint8Array(a);return window.crypto.getRandomValues(b),[].slice.call(b)[0]}},function(a,b,c){(function(a,d){var e=c(17).nextTick,f=Array.prototype.slice,g={},h=0;"undefined"!=typeof setTimeout&&(b.setTimeout=function(){return setTimeout.apply(window,arguments)}),"undefined"!=typeof clearTimeout&&(b.clearTimeout=function(){clearTimeout.apply(window,arguments)}),"undefined"!=typeof setInterval&&(b.setInterval=function(){return setInterval.apply(window,arguments)}),"undefined"!=typeof clearInterval&&(b.clearInterval=function(){clearInterval.apply(window,arguments)}),b.enroll=function(a,b){a._timeoutID=setTimeout(a._onTimeout,b)},b.unenroll=function(a){clearTimeout(a._timeoutID)},b.active=function(){},b.setImmediate="function"==typeof a?a:function(a){var c=h++,d=arguments.length<2?!1:f.call(arguments,1);return g[c]=!0,e(function(){g[c]&&(d?a.apply(null,d):a.call(null),b.clearImmediate(c))}),c},b.clearImmediate="function"==typeof d?d:function(a){delete g[a]}}).call(b,c(13).setImmediate,c(13).clearImmediate)},function(a){function b(){}var c=a.exports={};c.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){var c=d.shift();c()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),c.title="browser",c.browser=!0,c.env={},c.argv=[],c.on=b,c.addListener=b,c.once=b,c.off=b,c.removeListener=b,c.removeAllListeners=b,c.emit=b,c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")}},function(a){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a,b,c){var d,e,f=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};d=c(8),e=function(a){var b,c,e;return c=d(),b=window.ActiveXObject||XMLHttpRequest,e=new b("Microsoft.XMLHTTP"),e.open(a.type||(a.data?"POST":"GET"),a.url,!0),f.call(e,"overrideMimeType")>=0&&e.overrideMimeType(a.dataType||"text/plain"),e.onreadystatechange=function(){var b,d;4===e.readyState&&(0===(d=e.status)||200===d?(b=e.responseText,"application/json"===a.dataType&&(b=JSON.parse(b)),c(!0,b)):c(!1,new Error("Could not load "+a.url)))},a.data&&e.setRequestHeader("Content-type",a.dataType||"application/x-www-form-urlencoded"),e.send(a.data||null),c},a.exports={get:function(a,b){return b=b||{},b.url=a,b.type="GET",b.data=null,e(b)},post:function(a,b){return b=b||{},b.url=a,b.type="POST",e(b)}}},function(a){function b(){if(!f){f=!0;for(var a,b=e.length;b;){a=e,e=[];for(var c=-1;++c<b;)a[c]();b=e.length}f=!1}}function c(){}var d=a.exports={},e=[],f=!1;d.nextTick=function(a){e.push(a),f||setTimeout(b,0)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}}]);